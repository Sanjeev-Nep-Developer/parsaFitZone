<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title><%= title %> • <%= appName %></title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Loader -->
    <div id="loader" class="loader hidden">
      <div class="spinner"></div>
      <p>Loading...</p>
    </div>

    <% if (isAuthenticated) { %>
    <header class="header">
      <div class="brand">
        <span class="brand-title">FITZONE</span
        ><span class="brand-sub">PARSA</span>
      </div>
      <nav class="nav">
        <a href="/members/dashboard" class="nav-link">Dashboard</a>
        <a href="/members/lists/expiring" class="nav-link">Expiring</a>
        <a href="/members/lists/expired" class="nav-link">Expired</a>
        <a href="/members/add" class="nav-link primary">+ Add Member</a>
        <a href="/logout" class="nav-link danger">Logout</a>
      </nav>
    </header>
    <% } %>

    <main class="container">
      <% if (typeof success !== "undefined" && success.length) { %>
      <div class="alert success">✅ <%= success[0] %></div>
      <% } %> <% if (typeof error !== "undefined" && error.length) { %>
      <div class="alert error">❌ <%= error[0] %></div>
      <% } %> <% if (typeof warning !== "undefined" && warning.length) { %>
      <div class="alert warning">⚠️ <%= warning[0] %></div>
      <% } %> <%- body %>
    </main>

    <% if (isAuthenticated) { %>
    <footer class="footer">
      <p>© <%= new Date().getFullYear() %> FITZONE PARSA • Built with ❤️</p>
    </footer>
    <% } %>

    <script src="/js/main.js"></script>
    <script>
      // Loader
      document.querySelectorAll("form[data-loader]").forEach((form) => {
        form.addEventListener("submit", () => {
          document.getElementById("loader").classList.remove("hidden");
        });
      });

      // Auto-hide alerts
      setTimeout(() => {
        document.querySelectorAll(".alert").forEach((el) => el.remove());
      }, 4000);

      // Confirm delete
      document.querySelectorAll("form[data-confirm]").forEach((form) => {
        form.addEventListener("submit", (e) => {
          if (!confirm(form.getAttribute("data-confirm"))) {
            e.preventDefault();
          }
        });
      });
    </script>
  </body>
</html>
